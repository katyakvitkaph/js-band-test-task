(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"0HMw":function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("0HMw"),n("7qfE"),n("lYjL"),n("IlJM"),n("RtS0"),n("IvQZ"),n("uQK7"),n("8cZI"),n("lmye"),n("lAJ5"),n("D/wG"),n("JBxO"),n("JjHl"),n("FdtR"),n("4NM0"),n("3dw1"),n("wcNg");var r=n("L7iC"),i=n.n(r),o=n("czhI"),a=n.n(o);function s(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}var u=function(){function e(){this.server="http://158.101.166.74:8080/api/data/kate_kiriukhina",this.axios=a.a}var t=e.prototype;return t.initUser=function(){var e=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axios.post(this.server+"/users",t);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),t.getAllUsers=function(){var e=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axios.get(this.server+"/users");case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),t.addEvent=function(){var e=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axios.post(this.server+"/events",t);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),t.getAllEvents=function(){var e=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axios.get(this.server+"/events");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),t.deleteEvent=function(){var e=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axios.delete(this.server+"/events/"+t);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}();function l(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var d=new u,h=function(){function e(e){void 0===e&&(e=[]),this.items=e,this.selectedItemId=null,this.filteredItems=[]}var t=e.prototype;return t.filterItems=function(e){Object.values(e).every((function(e){return""===e}))&&(this.filteredItems=this.items),""!==e.nameOfMemberValue&&"All members"!==e.nameOfMemberValue&&(this.filteredItems=this.filteredItems.filter((function(t){return t.name.filter((function(t){return t===e.nameOfMemberValue})).join("")})))},t.getEvents=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getAllEvents().then((function(e){return e&&e.map((function(e){return JSON.parse(e.data)})).forEach((function(e){return n.items.push(e)})),n.items}));case 2:t();case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,s,"next",e)}function s(e){l(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),t.findItem=function(e){return this.items.find((function(t){return t.id===e}))},t.setSelectedItemId=function(e){this.selectedItemId=e},t.getSelectedItemId=function(){return this.selectedItemId},t.addItem=function(e){var t=e.title,n=e.name,r=e.dayOfWeek,o=e.time,a={id:i()(),title:t,name:n,time:o,dayOfWeek:r,row:["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"].indexOf(o),col:["Monday","Tuesday","Wednesday","Thursday","Friday"].indexOf(r)};null!==this.items&&(this.items.some((function(e){return e.dayOfWeek===a.dayOfWeek&&e.time===a.time}))?alert("Failed to create an event! Time slot is already booked"):this.items.push(a));return a},t.deleteItem=function(e){var t;d.getAllEvents().then((function(n){var r=n.map((function(e){return e.data})).find((function(t){return t.includes(e)})),i=n.filter((function(e){return e.data===r})).find((function(e){return e.id}));t=i.id,d.deleteEvent(t).then((function(e){}))})),this.items=this.items.filter((function(t){return t.id!==e}))},e}(),m=(n("4owi"),n("WB5j"),n("WoWj"),function(){function e(){this.events={}}var t=e.prototype;return t.on=function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},t.emit=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e]&&this.events[e].forEach((function(e){return e.apply(void 0,n)}))},e}());function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(e){this.name=e}var t,n,r;return t=e,(n=[{key:"name",get:function(){return this._name},set:function(e){return this._name=e}}])&&f(t.prototype,n),r&&f(t,r),e}();var p=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,t)||this)._role=n,r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r}(v),y={HELGA:"helga",PABLO:"pablo",KATE:"kate",ALEX:"alex"};function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var b=new u,g=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).formState={nameOfMemberValue:""},t.id=i()(),t.container=document.querySelector(".container"),t.authModal=document.querySelector(".modal-window-auth"),t.confirmUser=document.querySelector('button[data-action="confirm"]'),t.form=document.querySelector(".form"),t.main=document.querySelector(".main-content"),t.modal=document.querySelector(".modal-window"),t.selectNameMember=t.form.querySelector(".select--name"),t.createModalForm=t.modal.querySelector(".modal-form"),t.addNoteBtn=document.querySelector('button[data-action="add-note"]'),t.signoutBtn=document.querySelector('button[data-action="signout"]'),t.header=document.querySelector(".header-container"),t.cancelCreateBtn=document.querySelector('button[data-action="create-cancel"]'),$(document).ready((function(){$("#multiple-checkboxes").multiselect({includeSelectAllOption:!0})})),t.table=document.querySelector("table"),t.container.addEventListener("click",t.toggleDropdown),t.signoutBtn.addEventListener("click",t.signOut.bind(w(t))),t.selectNameMember.addEventListener("change",t.onSelectNameMemberChange.bind(w(t))),t.addNoteBtn.addEventListener("click",t.openCreateModal.bind(w(t))),t.createModalForm.addEventListener("submit",t.handleAdd.bind(w(t))),t.cancelCreateBtn.addEventListener("click",t.closeCreateModal.bind(w(t))),t.confirmUser.addEventListener("click",t.handleAuth.bind(w(t))),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.onSelectNameMemberChange=function(e){this.formState.nameOfMemberValue=e.target.value,this.emit("filter",this.formState)},o.handleAdd=function(e){e.preventDefault();var t=this.modal.querySelector(".modal-form__input"),n=this.modal.querySelector(".modal-form__select-day"),r=this.modal.querySelector(".modal-form__select-time"),i=this.modal.querySelector("#multiple-checkboxes"),o=Array.from(i.options).filter((function(e){return e.selected})).map((function(e){return e.value}));if(t.value){var a={title:t.value.length>15?t.value.slice(0,16)+"...":t.value,dayOfWeek:n.value,time:r.value,name:o};this.emit("add",a),this.createModalForm.reset(),this.closeCreateModal()}else alert("Please, fill the field!")},o.createDOMElement=function(e,t,n){var r=document.createElement(e);t&&(r.dataset[t[0]]=t[1]),n&&(r.textContent=n);for(var i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return o.forEach((function(e){return r.classList.add(e)})),r},o.createGreetings=function(e){return this.createDOMElement("h2",null,e,"name-user")},o.createNote=function(e){var t=this.createDOMElement("section",null,null,"event-list__section"),n=this.createDOMElement("div",["id",e.id],null,"item"),r=this.createDOMElement("h2",null,e.title,"item__title"),i=this.createDOMElement("div",null,null,"buttons-container"),o=this.createDOMElement("button",["action","delete"],"","button-delete");return i.append(o),n.append(r,i),t.append(n),this.appendEventListners(t),t},o.appendEventListners=function(e){e.querySelector('button[data-action="delete"]').addEventListener("click",this.handleDelete.bind(this))},o.handleDelete=function(e){var t=e.target.closest(".item");e.stopPropagation(),this.emit("delete",t.dataset.id)},o.deleteNote=function(e){this.table.querySelector('[data-id="'+e+'"]').closest("section").remove()},o.openCreateModal=function(){this.container.classList.add("modal--show")},o.closeCreateModal=function(){this.container.classList.remove("modal--show")},o.closeAuthModal=function(){this.container.classList.remove("modal--auth--show")},o.handleAuth=function(e){var t,n=this;e.preventDefault();var r=this.authModal.querySelector(".modal-form__select-name"),i=r.value.toLowerCase(),o=this.table.querySelectorAll('button[data-action="delete"]');switch(b.getAllUsers().then((function(e){return!e.data.some((function(e){return e.data===i}))&&b.initUser({data:""+i,id:n.id}).then((function(e){return e}))})),i){case y.ALEX:t=new p(i,!0),o.forEach((function(e){e.style.display="block"}));break;case y.HELGA:case y.PABLO:case y.KATE:t=new v(i),this.addNoteBtn.style.display="none",o.forEach((function(e){e.style.display="none"}));break;default:return}this.header.append(this.createGreetings("Hello, "+r.value)),localStorage.setItem("userRole",t._role),this.closeAuthModal()},o.signOut=function(){localStorage.removeItem("userRole"),location.reload()},o.init=function(e){var t,n=this;t=localStorage.getItem("userRole");for(var r=null,i=this.table.getElementsByTagName("td"),o=0;o<i.length;o++)i[o].innerHTML="";e.forEach((function(e){0===(r=n.table.rows[e.row+1].cells[e.col+1]).getElementsByTagName("section").length&&r.append(n.createNote(e))}));var a=this.table.querySelectorAll('button[data-action="delete"]');"true"!==t&&a.forEach((function(e){e.style.display="none"}))},o.nothingsFound=function(){for(var e=this.table.getElementsByTagName("td"),t=0;t<e.length;t++)e[t].innerHTML=""},r}(m),E=new u,M=function(){function e(e,t){var n=this;this.model=e,this.view=t,this.view.on("add",this.addNote.bind(this)),this.view.on("delete",this.deleteNote.bind(this)),this.view.on("filter",this.handleFilter.bind(this)),this.view.on("create-cancel",this.handleCreateCancel.bind(this)),this.model.getEvents((function(){return n.view.init(n.model.items)}))}var t=e.prototype;return t.handleFilter=function(e){this.model.filterItems(e),console.log("this.model.filteredItems",this.model.filteredItems),this.model.filteredItems.length?this.view.init(this.model.filteredItems):this.view.nothingsFound(),this.model.filteredItems=this.model.items},t.showAllNotes=function(){this.view.init(this.model.items)},t.handleCreateCancel=function(){this.view.closeCreateModal()},t.addNote=function(e){try{E.addEvent({data:JSON.stringify(this.model.addItem(e))}).then((function(e){return e.data}))}catch(e){console.error("Error while parsing.")}this.showAllNotes()},t.deleteNote=function(e){this.model.deleteItem(e),this.view.deleteNote(e)},e}(),S=new g;new M(new h,S)}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.44233b26b088ff53639f.js.map